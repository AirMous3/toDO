(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{142:function(t,e,n){},148:function(t,e,n){},174:function(t,e,n){"use strict";n.r(e);var a,c,i=n(0),r=n.n(i),s=n(36),o=n.n(s),l=(n(142),n(17)),d=(n(148),n(114)),u=n.n(d),j=n(237),b=n(236),O=n(123),f=n(239),h=n(238),m=n(13),p=n(110),g=n.n(p).a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"API-KEY":"1dbc4cf7-1f30-4d66-936b-be5fca3239ce"}}),x=function(){return g.get("todo-lists")},T=function(t){return g.post("todo-lists",{title:t})},v=function(t){return g.delete("todo-lists/".concat(t))},S=function(t,e){return g.put("todo-lists/".concat(t),{title:e})},I=function(t){return g.get("todo-lists/".concat(t,"/tasks"))},y=function(t,e){return g.delete("todo-lists/".concat(t,"/tasks/").concat(e))},C=function(t,e){return g.post("todo-lists/".concat(t,"/tasks"),{title:e})},k=function(t,e,n){return g.put("todo-lists/".concat(t,"/tasks/").concat(e),n)},E=function(t){return g.post("auth/login",t)},A=function(){return g.delete("auth/login")},w=function(){return g.get("auth/me")};!function(t){t[t.New=0]="New",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed",t[t.Draft=3]="Draft"}(a||(a={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.Hi=2]="Hi",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(c||(c={}));var D={status:"idle",error:null,isInitialized:!1},L=function(t){return{type:"CHANGE-STATUS",status:t}},N=function(t){return{type:"SET-APP-ERROR",error:t}},R=function(t){return{type:"SET-INITIALIZE",value:t}},_={isLogged:!1},P=function(t){return{type:"IS-LOGGED-IN",value:t}},M=n(1),G=function(){var t=Object(l.c)((function(t){return t.loggin.isLogged})),e=Object(l.b)(),n=function(){return e((function(t){t(L("loading")),A().then((function(e){0===e.data.resultCode?(t(P(!1)),t(L("succeeded"))):(t(N(e.data.messages[0])),t(L("failed")))}))}))};return Object(M.jsx)(b.a,{sx:{flexGrow:1},children:Object(M.jsx)(j.a,{position:"static",color:"transparent",children:Object(M.jsxs)(h.a,{style:{display:"flex",justifyContent:"space-between"},children:[Object(M.jsx)(f.a,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2},children:Object(M.jsx)(u.a,{})}),t?Object(M.jsx)(O.a,{onClick:function(){return n()},color:"inherit",children:"logOut"}):Object(M.jsx)(O.a,{href:"/login",color:"inherit",children:"login"})]})})})},H=n(14),K=n(240);function z(){var t=i.useState(0),e=Object(H.a)(t,2),n=e[0],a=e[1],c=i.useState(10),r=Object(H.a)(c,2),s=r[0],o=r[1],l=i.useRef((function(){}));return i.useEffect((function(){l.current=function(){if(n>100)a(0),o(10);else{var t=10*Math.random(),e=10*Math.random();a(n+t),o(n+t+e)}}})),i.useEffect((function(){var t=setInterval((function(){l.current()}),500);return function(){clearInterval(t)}}),[]),Object(M.jsx)(b.a,{sx:{width:"100%"},children:Object(M.jsx)(K.a,{variant:"buffer",value:n,valueBuffer:s})})}var B=n(222),U=n(232),F=n(230),W=i.forwardRef((function(t,e){return Object(M.jsx)(F.a,Object(m.a)({elevation:6,ref:e,variant:"filled"},t))}));function V(){var t=Object(l.b)(),e=Object(l.c)((function(t){return t.app.error})),n=function(e,n){"clickaway"!==n&&t(N(null))};return Object(M.jsx)(B.a,{spacing:2,sx:{width:"100%"},children:Object(M.jsx)(U.a,{open:null!==e,autoHideDuration:6e3,onClose:n,children:Object(M.jsx)(W,{onClose:n,severity:"error",sx:{width:"100%"},children:e})})})}var Y=n(77),Z=n(122),q=n(228),J=n(15),$=n(5),Q=n(233),X=(Object(Q.a)(),Object(Q.a)(),[]),tt=function(t,e){return{type:"CHANGE-TODOLIST-FILTER",id:t,filter:e}},et=function(t,e){return{type:"CHANGE-TODOLIST-ENTITY-STATUS",todolistId:t,entityStatus:e}},nt={},at=function(t,e,n){return{type:"CHANGE-TASK-ENTITY-STATUS",todolistId:t,entityStatus:n,taskId:e}},ct=function(t,e,n){return function(a,c){a(L("loading")),a(at(t,e,"loading"));var i=c().tasks[t].find((function(t){return t.id===e}));if(i){var r=Object(m.a)({title:i.title,description:i.description,status:i.status,priority:i.priority,startDate:i.startDate,deadline:i.deadline},n);k(t,e,r).then((function(n){0===n.data.resultCode?(a(function(t,e,n){return{type:"UPDATE-TASK",todolistId:t,taskId:e,model:n}}(t,e,r)),a(L("succeeded")),a(at(t,e,"succeeded"))):(a(N(n.data.messages[0])),a(L("failed")),a(at(t,e,"succeeded")))})).catch((function(t){a(N(t.message)),a(L("failed"))}))}else console.warn("task not found in state")}},it=n(226),rt=n(72),st=r.a.memo((function(t){console.log("ADD ITEM FORM");var e=Object(i.useState)(""),n=Object(H.a)(e,2),a=n[0],c=n[1],r=Object(i.useState)(null),s=Object(H.a)(r,2),o=s[0],l=s[1],d=function(){""!==a.trim()?(t.addItemCallBack(a.trim()),c("")):l("Text incorrect")};return Object(M.jsxs)("div",{style:{padding:"10px"},children:[Object(M.jsx)(rt.a,{style:{minWidth:"300px"},helperText:o,value:a,label:"Type",onChange:function(t){c(t.currentTarget.value)},onKeyPress:function(t){o&&l(null),13===t.charCode&&d()},error:!!o}),Object(M.jsx)(O.a,{style:{marginRight:"-10px"},size:"large",variant:"text",onClick:d,disabled:t.disabled,children:Object(M.jsx)(it.a,{})})]})})),ot=r.a.memo((function(t){console.log("SPAN RENDER");var e=Object(i.useState)(!1),n=Object(H.a)(e,2),a=n[0],c=n[1],r=Object(i.useState)(""),s=Object(H.a)(r,2),o=s[0],l=s[1],d=function(){c(!0),l(t.title)};return a?Object(M.jsx)(rt.a,{disabled:"loading"===t.entityStatus||"loading"===t.entityTaskStatus,onKeyPress:function(e){13===e.charCode&&(c(!1),t.onChangeCallBack(o))},onBlur:function(){c(!1),t.onChangeCallBack(o)},autoFocus:!0,onDoubleClick:d,onChange:function(t){l(t.currentTarget.value)},value:o}):Object(M.jsx)("span",{onDoubleClick:d,children:t.title})})),lt=n(48),dt=n.n(lt),ut=n(231),jt=n(227),bt=r.a.memo((function(t){var e=t.task,n=t.todolistId,c=t.entityStatus,r=Object(l.b)(),s=Object(i.useCallback)((function(t){r(ct(n,e.id,{title:t}))}),[r,e.id,n]);return Object(M.jsxs)("div",{className:"".concat(dt.a.tasks," ").concat(e.status===a.Completed?dt.a.isDone:""),children:["  ",Object(M.jsx)(ut.a,{disabled:"loading"===c,size:"small",checked:e.status===a.Completed,onChange:function(t){r(ct(e.todoListId,e.id,{status:t.currentTarget.checked?a.Completed:a.New}))}})," ",Object(M.jsx)("div",{style:{maxWidth:"250px",minWidth:"250px"},children:Object(M.jsx)(ot,{entityTaskStatus:c,title:e.title,onChangeCallBack:s})}),Object(M.jsx)("div",{children:Object(M.jsx)(O.a,{disabled:"loading"===c,size:"small",onClick:function(){return r(function(t,e){return function(n){n(L("loading")),n(at(e,t,"loading")),y(e,t).then((function(){n(function(t,e){return{type:"REMOVE-TASK",taskId:t,todolistId:e}}(t,e)),n(L("succeeded"))}))}}(e.id,n))},children:Object(M.jsx)(jt.a,{})})})]},e.id)})),Ot=r.a.memo((function(t){var e=t.todolistId,n=t.title,c=t.filter,r=t.entityStatus;console.log("TODOLIST");var s=Object(l.b)(),o=Object(l.c)((function(t){return t.tasks[e]})),d=Object(i.useCallback)((function(t){return s(function(t,e){return function(n){n(L("loading")),n(et(t,"loading")),C(t,e).then((function(e){if(0===e.data.resultCode){var a=Object(m.a)(Object(m.a)({},e.data.data.item),{},{entityStatus:"idle"});n(function(t){return{type:"ADD-TASK",task:t}}(a)),n(L("succeeded")),n(et(t,"idle"))}else e.data.messages.length>0?(n(N(e.data.messages[0])),n(L("succeeded")),n(et(t,"idle"))):(n(N("some error")),n(et(t,"idle")),n(L("failed")))}))}}(e,t))}),[e,s]),u=Object(i.useCallback)((function(t){return s(function(t,e){return function(n){n(L("loading")),n(et(t,"loading")),S(t,e).then((function(){n(function(t,e){return{type:"CHANGE-TODOLIST-TITLE",id:t,title:e}}(t,e)),n(L("succeeded")),n(et(t,"succeeded"))}))}}(e,t))}),[s,e]),j=Object(i.useCallback)((function(){return s(function(t){return function(e){e(L("loading")),e(et(t,"loading")),v(t).then((function(){e({type:"REMOVE-TODOLIST",id:t}),e(L("succeeded"))}))}}(e))}),[s,e]),b=Object(i.useCallback)((function(){return s(tt(e,"all"))}),[e,s]),f=Object(i.useCallback)((function(){return s(tt(e,"active"))}),[e,s]),h=Object(i.useCallback)((function(){return s(tt(e,"completed"))}),[e,s]);return Object(i.useEffect)((function(){s(function(t){return function(e){return e(L("loading")),I(t).then((function(n){var a=n.data.items.map((function(t){return Object(m.a)(Object(m.a)({},t),{},{entityStatus:"idle"})}));e(function(t,e){return{type:"SET-TASKS",tasks:t,todolistId:e}}(a,t)),e(L("succeeded"))}))}}(e))}),[s,e]),"active"===c&&(o=o.filter((function(t){return t.status===a.New}))),"completed"===c&&(o=o.filter((function(t){return t.status===a.Completed}))),Object(M.jsxs)("div",{className:dt.a.container,children:[Object(M.jsxs)("h3",{className:dt.a.span,children:[Object(M.jsx)("div",{style:{maxWidth:"250px",width:"250px",textAlign:"center"},children:Object(M.jsx)(ot,{entityStatus:r,title:n,onChangeCallBack:u})}),Object(M.jsx)("div",{className:dt.a.deleteTodolistIcon,children:Object(M.jsx)(O.a,{size:"small",onClick:j,disabled:"loading"===r,children:Object(M.jsx)(q.a,{})})})]}),Object(M.jsx)(st,{addItemCallBack:d,disabled:"loading"===r}),Object(M.jsx)("div",{children:o.map((function(t){return Object(M.jsx)(bt,{task:t,todolistId:e,entityStatus:t.entityStatus},t.id)}))}),Object(M.jsxs)("div",{className:dt.a.status,children:[Object(M.jsx)(O.a,{size:"small",variant:"all"===c?"contained":"text",onClick:b,children:"All"}),Object(M.jsx)(O.a,{size:"small",color:"primary",variant:"active"===c?"contained":"text",onClick:f,children:"Active"}),Object(M.jsx)(O.a,{size:"small",color:"warning",variant:"completed"===c?"contained":"text",onClick:h,children:"Completed"})]})]})})),ft=n(19),ht=function(t){var e=Object(l.b)(),n=Object(i.useCallback)((function(t){return e(function(t){return function(e){e(L("loading")),T(t).then((function(n){if(0===n.data.resultCode){var a=n.data.data.item;e(function(t,e){return{type:"ADD-TODOLIST",title:t,payload:e}}(t,a)),e(L("succeeded"))}else n.data.messages.length>0?(e(N(n.data.messages[0])),e(L("succeeded"))):(e(N("some error")),e(L("succeeded")))}))}}(t))}),[e]),a=Object(l.c)((function(t){return t.loggin.isLogged})),c=Object(l.c)((function(t){return t.todolists}));return Object(i.useEffect)((function(){e((function(t){t(L("loading")),x().then((function(e){t({type:"SET-TODOLISTS",todolists:e.data}),t(L("succeeded"))})).catch((function(e){t(N(e.message)),t(L("failed"))}))}))}),[e]),a?Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(Y.a,{container:!0,style:{padding:"20px"},justifyContent:"center",children:Object(M.jsx)(st,{addItemCallBack:n,disabled:"loading"===t.status})}),Object(M.jsx)(Y.a,{container:!0,spacing:2,justifyContent:"center",children:c.map((function(t){return Object(M.jsx)(Y.a,{item:!0,children:Object(M.jsx)(Z.a,{style:{padding:"20px"},children:Object(M.jsx)(Ot,{todolistId:t.id,title:t.title,filter:t.filter,entityStatus:t.entityStatus},t.id)})})}))})]}):Object(M.jsx)(ft.a,{to:"/login"})},mt=n(241),pt=n(234),gt=n(242),xt=n(225),Tt=n(119),vt=function(){var t=Object(l.c)((function(t){return t.loggin.isLogged})),e=Object(l.b)(),n=Object(Tt.a)({initialValues:{email:"",password:"",rememberMe:!1},onSubmit:function(t){var a;e((a=t,function(t){t(L("loading")),E(a).then((function(e){0===e.data.resultCode?(t(P(!0)),t(L("succeeded"))):(t(N(e.data.messages[0])),t(L("failed")))}))})),n.resetForm({values:{email:"",password:"",rememberMe:!1}})},validate:function(t){var e={};return t.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(t.email)||(e.email="Invalid email address"):e.email="Required",t.password?t.password.length<=2&&(e.password="Length of password should be more then 2"):e.password="Required",e}});return t?Object(M.jsx)(ft.a,{to:"/"}):Object(M.jsx)("form",{onSubmit:n.handleSubmit,children:Object(M.jsx)(Y.a,{container:!0,justifyContent:"center",children:Object(M.jsx)(Y.a,{item:!0,justifyContent:"center",children:Object(M.jsxs)(mt.a,{children:[Object(M.jsxs)(xt.a,{children:[Object(M.jsxs)("p",{children:["To log in get registered",Object(M.jsx)("a",{href:"https://social-network.samuraijs.com/",target:"_blank",children:" here"})]}),Object(M.jsx)("p",{children:"or use common test account credentials:"}),Object(M.jsx)("p",{children:"Email: free@samuraijs.com"}),Object(M.jsx)("p",{children:"Password: free"})]}),Object(M.jsxs)(gt.a,{children:[Object(M.jsx)(rt.a,Object(m.a)(Object(m.a)({},n.getFieldProps("email")),{},{label:"Email",margin:"normal"})),n.touched.email&&n.errors.email?Object(M.jsx)("div",{style:{color:"red"},children:n.errors.email}):null,Object(M.jsx)(rt.a,Object(m.a)(Object(m.a)({},n.getFieldProps("password")),{},{type:"password",label:"Password",margin:"normal"})),n.touched.password&&n.errors.password?Object(M.jsx)("div",{style:{color:"red"},children:n.errors.password}):null,Object(M.jsx)(pt.a,{label:"Remember me",control:Object(M.jsx)(ut.a,Object(m.a)({},n.getFieldProps("rememberMe")))}),Object(M.jsx)(O.a,{type:"submit",variant:"contained",color:"primary",children:"Login"})]})]})})})})},St=n(121);var It=function(){var t=Object(l.b)(),e=Object(l.c)((function(t){return t.app.status})),n=Object(l.c)((function(t){return t.app.isInitialized}));return Object(i.useEffect)((function(){t((function(t){w().then((function(e){0===e.data.resultCode&&(t(R(!0)),t(P(!0)))})).finally((function(){t(R(!0))}))}))}),[]),n?Object(M.jsxs)("div",{className:"App",children:[Object(M.jsx)(G,{}),Object(M.jsx)(V,{}),"loading"===e&&Object(M.jsx)(z,{}),Object(M.jsx)(St.a,{maxWidth:"xl",children:Object(M.jsxs)(ft.d,{children:[Object(M.jsx)(ft.b,{exact:!0,path:"/",render:function(){return Object(M.jsx)(ht,{status:e})}}),Object(M.jsx)(ft.b,{path:"/login",render:function(){return Object(M.jsx)(vt,{})}}),Object(M.jsx)(ft.b,{path:"/404",render:function(){return Object(M.jsx)("h1",{children:"404 page not found (\uff03\uff1e\uff1c)"})}}),Object(M.jsx)(ft.a,{from:"*",to:"/404"})]})})]}):Object(M.jsx)(K.a,{})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var yt=n(76),Ct=n(118),kt=Object(yt.b)({tasks:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"REMOVE-TASK":return Object(m.a)(Object(m.a)({},t),{},Object($.a)({},e.todolistId,t[e.todolistId].filter((function(t){return t.id!==e.taskId}))));case"ADD-TASK":return Object(m.a)(Object(m.a)({},t),{},Object($.a)({},e.task.todoListId,[e.task].concat(Object(J.a)(t[e.task.todoListId]))));case"UPDATE-TASK":return Object(m.a)(Object(m.a)({},t),{},Object($.a)({},e.todolistId,t[e.todolistId].map((function(t){return t.id===e.taskId?Object(m.a)(Object(m.a)({},t),e.model):t}))));case"ADD-TODOLIST":return Object(m.a)(Object(m.a)({},t),{},Object($.a)({},e.payload.id,[]));case"REMOVE-TODOLIST":var n=Object(m.a)({},t);return delete n[e.id],n;case"SET-TODOLISTS":var a=Object(m.a)({},t);return e.todolists.forEach((function(t){return a[t.id]=[]})),a;case"CHANGE-TASK-ENTITY-STATUS":return Object(m.a)(Object(m.a)({},t),{},Object($.a)({},e.todolistId,t[e.todolistId].map((function(t){return t.id===e.taskId?Object(m.a)(Object(m.a)({},t),{},{entityStatus:e.entityStatus}):t}))));case"SET-TASKS":var c=Object(m.a)({},t);return c[e.todolistId]=e.tasks,c;default:return t}},todolists:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"REMOVE-TODOLIST":return t.filter((function(t){return t.id!==e.id}));case"ADD-TODOLIST":return[Object(m.a)(Object(m.a)({},e.payload),{},{filter:"all",entityStatus:"idle"})].concat(Object(J.a)(t));case"CHANGE-TODOLIST-TITLE":return t.map((function(t){return t.id===e.id?Object(m.a)(Object(m.a)({},t),{},{title:e.title}):t}));case"CHANGE-TODOLIST-FILTER":return t.map((function(t){return t.id===e.id?Object(m.a)(Object(m.a)({},t),{},{filter:e.filter}):t}));case"SET-TODOLISTS":return e.todolists.map((function(t){return Object(m.a)(Object(m.a)({},t),{},{filter:"all",entityStatus:"idle"})}));case"CHANGE-TODOLIST-ENTITY-STATUS":return t.map((function(t){return t.id===e.todolistId?Object(m.a)(Object(m.a)({},t),{},{entityStatus:e.entityStatus}):t}));default:return t}},app:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"CHANGE-STATUS":return Object(m.a)(Object(m.a)({},t),{},{status:e.status});case"SET-APP-ERROR":return Object(m.a)(Object(m.a)({},t),{},{error:e.error});case"SET-INITIALIZE":return Object(m.a)(Object(m.a)({},t),{},{isInitialized:e.value});default:return t}},loggin:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,e=arguments.length>1?arguments[1]:void 0;return"IS-LOGGED-IN"===e.type?Object(m.a)(Object(m.a)({},t),{},{isLogged:e.value}):t}}),Et=Object(yt.c)(kt,Object(yt.a)(Ct.a)),At=n(58);o.a.render(Object(M.jsx)(At.a,{children:Object(M.jsx)(l.a,{store:Et,children:Object(M.jsx)(It,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},48:function(t,e,n){t.exports={container:"Todolist_container__2-MrN",span:"Todolist_span__i5ptW",deleteTodolistIcon:"Todolist_deleteTodolistIcon__20CNq",tasks:"Todolist_tasks__lJ4gM",isDone:"Todolist_isDone__yiSji",status:"Todolist_status__1cgdq"}}},[[174,1,2]]]);
//# sourceMappingURL=main.83b0a8ba.chunk.js.map